<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'" />
  <meta name="google-site-verification" content="tsC40Go6u6ldH1pmeafOZhKJc7v1dxGQ6lYzxqlkN2I" />
<!-- * PwdHash-PoC
     * Version of PwdHash amended to fix various flaws in the original implementation
     * This version uses PBKDF2-SHA256 and allows control over the user-specified salt
     * and iteration count.
     * Version 0.1 Copyright (C) Cambridge University 2016
     * Contributors: David Llewellyn-Jones, Graham Rymer
     * Distributed under the BSD License
     *-->

<!--* Remote PwdHash Form
      * An HTML form that calls the JavaScript implementation of PwdHash
      * Version 1.0 Copyright (C) Stanford University 2004-2005
      * Contributors: Dan Boneh, Collin Jackson, John Mitchell, Nick Miyake, and Blake Ross
      * Distributed under the BSD License
      * See http://crypto.stanford.edu/PwdHash for more info.
      *-->
  <title>PwdHash Enhanced</title>
  <script src="js/forge.min.js"></script>

  <script src="js/pwdhash.js" type="text/javascript"></script>
  <script src="js/hashed-password.js" type="text/javascript"></script>
  <script src="js/domain-extractor.js" type="text/javascript"></script>
  <script src="js/site-requirements.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="style/pwdhash.css" />
  <link rel="shortcut icon" href="favicon.ico" />
</head>
<body onLoad="Init();">
<main>
<table class="leftmargin"><tr><td>
<form name="hashform" action="error.html" method="POST"
onsubmit="return TimedGenerate();">
<table id="theHashForm">
<noscript>
<tr><td colspan="2">
<p>
Please enable Javascript to use this
</p>
</td></tr>
</noscript>
<tr>
<td class="stepList" colspan="2">
<div class="step" id="theSiteDomain">
<h3>Keyword</h3>
<p>
  <span class="keyword-row">
    <input type="text" name="domain" id="keywordInput">
    <button type="button" class="keyword-clear" id="keywordClear" aria-label="Clear keyword" title="Clear keyword">&times;</button>
  </span>
</p>
</div>
<div class="step" id="theSitePassword">
<h3>Secret Password</h3>
<p><input type="password" name="sitePassword"></p>
</div>
</td>
</tr>
<tr>
<td class="stepList" colspan="2">
<div class="step" id="theHashedPassword">
<h3>Hashed Password</h3>
  <span id="theGeneratePanel">
    <input type="text" name="hashedPassword">
  </span>

</div>
</td>
</tr>
<tr>
<td class="stepList config" colspan="2">
<div class="step" id="theUserSalt">
<h3>Secret Salt</h3>
<p><input type="text" name="salt" value="ChangeMe"></p>
<p id="salt-error-message" class="error-message" aria-live="polite" style="display: none;">Please change the default salt to a memorable secret phrase</p>
</div>
<div class="step" id="theIterations">
<h3>Iterations</h3>
<p><input type="number" name="iterations" value="50000"></p>
</div>
<span class="config-note">
Remember your secret salt and iterations for other devices
</span>
</td>
</tr>

</table>

</td></tr><tr><td><div class="footer">Enhanced version: 1.0</div>
<div class="footer">Tip: You can save this page to disk.</div>
</td></tr></table>

<h1 class="main-title">PwdHash Enhanced</h1>

<section id="theexplanation">
<p>
PwdHash Enhanced generates site-specific passwords from a master password. It builds on <a href="http://www.flypig.co.uk/pwdhash/">Cambridge's PwdHash-PoC</a>, which itself improved upon the original <a href="https://www.pwdhash.com">Stanford PwdHash</a>. This version adds configurable password requirements (length limits, character rules) and auto-detection of common site policies.</p>

<p>PwdHash will not turn a weak password into a strong one. <b>Always ensure your master password is sufficiently complex</b>.</p>

<h3>Bookmarklet</h3>
<p>Drag this link to your bookmarks bar: <a href="javascript:(function(){var n='pwdhash_window',b='https://dimmingmuse.github.io/pwdhash-enhanced/site/',f='location=yes,height=550,width=340,scrollbars=yes,status=yes',d=(location.hostname||'').replace(/^www\./,''),u=b+(d?'?site='+encodeURIComponent(d):''),w=window.open(u,n,f);w.focus();})();">PwdHash</a></p>

<h3>Background</h3>
<ul>
<li>Original <a href="https://www.pwdhash.com">Stanford PwdHash</a> (2004-2005) by Dan Boneh, Collin Jackson, John Mitchell, Nick Miyake, and Blake Ross</li>
<li><a href="http://www.flypig.co.uk/pwdhash/">Cambridge PwdHash-PoC</a> (2016) by <a href="http://www.cl.cam.ac.uk/~dl551/">David Llewellyn-Jones</a> and <a href="https://www.cl.cam.ac.uk/people/#gr348">Graham Rymer</a> - fixed flaws in original, uses PBKDF2-SHA512</li>
<li><a href="http://www.flypig.co.uk/papers/dlj-gr-passwords16.pdf">Cracking PwdHash paper</a> (PDF)</li>
<li><a href="https://chrome.google.com/webstore/detail/pwdhash-poc-port/lofhgnhbjellcpcdpkbejffjejhchacj">Chrome extension</a> by <a href="https://github.com/CyBot">CyBot</a></li>
</ul>
</section>
</form>

<footer class="textcentre footer-attribution">
 Enhanced version modifications are not affiliated with Cambridge or Stanford.
</footer>
</main>
<script src="js/pwdhash-enhanced.js"></script>
</body>
</html>
